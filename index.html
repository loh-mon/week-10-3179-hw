<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Australian Migration Visualisations</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <style>
    body {font-family: Arial, sans-serif; margin: 0; background: #f9fafb; color: #111;}
    h1 {text-align: center; padding: 16px;}
    .container {display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px;}
    .chart {flex: 1 1 500px; min-width: 480px; background: white; padding: 10px; border-radius: 8px; box-shadow: 0 0 8px rgba(0,0,0,0.1);}
  </style>
</head>
<body>
  <h1>Australian Migration Visualisations</h1>
  <div class="container">
    <div id="chart1" class="chart"></div>
    <div id="chart2" class="chart"></div>
  </div>

  <script type="application/json" id="spec1">
  {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 500,
    "height": 350,
    "title": {"text": "Australia: Arrivals, Departures, Net Overseas Migration", "fontWeight": "bold"},
    "data": {"url": "https://raw.githubusercontent.com/loh-0/australian-migration/refs/heads/main/net_flow_migration.csv"},
    "params": [{"name": "yrSel", "value": 2023, "bind": {"input": "range", "min": 2004, "max": 2023, "step": 1, "name": "Year: "}}],
    "transform": [
      {"fold": ["australian_born", "overseas_born", "total"], "as": ["series_key", "value"]},
      {"calculate": "datum.series_key === 'australian_born' ? 'Australian-born' : datum.series_key === 'overseas_born' ? 'Overseas-born' : 'Total (net)'", "as": "Series"}
    ],
    "layer": [
      {"mark": {"type": "line", "strokeWidth": 2},
       "encoding": {
         "x": {"field": "year", "type": "quantitative", "axis": {"format": "d", "title": "Year"}},
         "y": {"field": "value", "type": "quantitative", "title": "People"},
         "color": {"field": "Series", "scale": {"domain": ["Australian-born", "Overseas-born", "Total (net)"], "range": ["#4c78a8", "#f58518", "#54a24b"]}},
         "tooltip": [{"field": "Series"}, {"field": "year"}, {"field": "value", "format": ","}]
       }
      },
      {"transform": [{"calculate": "yrSel", "as": "x"}], "mark": {"type": "rule", "stroke": "#666", "strokeDash": [4,4]}, "encoding": {"x": {"field": "x", "type": "quantitative"}}}
    ],
    "config": {"background": "#f7fbff"}
  }
  </script>

  <script type="application/json" id="spec2">
  {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 500,
    "height": 350,
    "title": "Visa Arrivals by Type (2004â€“2023)",
    "data": {"url": "https://raw.githubusercontent.com/loh-0/fit3179-week9-map/refs/heads/main/migration_visa.csv"},
    "mark": {"type": "area", "interpolate": "monotone"},
    "encoding": {
      "x": {"field": "Year", "type": "quantitative", "title": "Year", "axis": {"format": "d"}},
      "y": {"field": "Arrivals", "type": "quantitative", "title": "Number of Arrivals"},
      "color": {"field": "Visa Type", "type": "nominal", "title": "Visa Type"},
      "tooltip": [
        {"field": "Visa Type", "title": "Visa Type"},
        {"field": "Year", "type": "quantitative", "title": "Year", "format": "d"},
        {"field": "Arrivals", "type": "quantitative", "title": "Arrivals", "format": ","}
      ]
    },
    "config": {"background": "#f7fbff"}
  }
  </script>

  <script>
    const spec1 = JSON.parse(document.getElementById('spec1').textContent);
    const spec2 = JSON.parse(document.getElementById('spec2').textContent);
    vegaEmbed('#chart1', spec1, {actions:false});
    vegaEmbed('#chart2', spec2, {actions:false});
  </script>
</body>
</html>
